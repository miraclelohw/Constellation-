<!-- ============================================================================ -->
<!-- MODULE 1 : HTML HEADER + CSS                                             -->
<!-- ============================================================================ -->

<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Jeu d'Actions Intimes üî•</title>
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Quicksand:wght@400;500;600&family=Playfair+Display:wght@600&display=swap" rel="stylesheet">

  <style>
    :root {
      --violet: #8b5cf6;
      --rose: #ff6b9d;
      --peche: #ff8fab;
      --dark: #1a0033;
      --darker: #0f001a;
    }
    
    * { margin:0; padding:0; box-sizing:border-box; }
    
    body {
      font-family: 'Quicksand', sans-serif;
      background: linear-gradient(135deg, var(--dark), var(--darker));
      color: white;
      min-height: 100vh;
      padding: 20px;
      text-align: center;
    }
    
    .card {
      max-width: 720px;
      margin: 30px auto;
      background: rgba(255,255,255,0.06);
      backdrop-filter: blur(12px);
      border-radius: 24px;
      border: 1px solid rgba(255,255,255,0.12);
      padding: 32px;
      box-shadow: 0 20px 60px rgba(0,0,0,0.45);
    }
    
    h1, h2 { font-family: 'Playfair Display', serif; margin-bottom: 24px; }
    .hidden { display: none !important; }
    
    input[type="text"], input[type="url"] {
      width: 100%;
      padding: 14px 18px;
      margin: 12px 0;
      border: 2px solid var(--peche);
      border-radius: 12px;
      background: rgba(255,255,255,0.08);
      color: white;
      font-size: 1.05em;
    }
    
    input::placeholder { color: rgba(255,255,255,0.5); }
    
    input:focus {
      outline: none;
      border-color: var(--rose);
      box-shadow: 0 0 0 3px rgba(255,107,157,0.2);
    }
    
    button {
      padding: 14px 28px;
      font-size: 1.1em;
      font-weight: 600;
      border: none;
      border-radius: 50px;
      cursor: pointer;
      margin: 12px;
      transition: all 0.3s;
    }
    
    button:disabled {
      opacity: 0.5;
      cursor: not-allowed;
    }
    
    .btn-primary { background: linear-gradient(45deg, var(--rose), var(--peche)); color: white; }
    .btn-secondary { background: rgba(255,255,255,0.15); color: white; }
    button:hover:not(:disabled) { transform: translateY(-3px); box-shadow: 0 12px 30px rgba(255,107,157,0.4); }
    
    /* BOUTONS DE CHOIX DE MODE */
    .mode-btn {
      background: rgba(255,255,255,0.08);
      color: white;
      display: block;
      width: 100%;
      max-width: 450px;
      margin: 20px auto;
      padding: 30px;
      text-align: left;
      border: 2px solid rgba(255,255,255,0.2);
      border-radius: 20px;
      transition: all 0.3s;
      cursor: pointer;
    }
    
    .mode-btn:hover {
      background: rgba(255,107,157,0.2);
      border-color: var(--rose);
      transform: translateY(-5px);
      box-shadow: 0 15px 40px rgba(255,107,157,0.3);
    }
    
    .mode-btn .icon { 
      font-size: 3em; 
      margin-bottom: 15px; 
      display: block;
    }
    
    .mode-btn .title { 
      font-size: 1.4em; 
      font-weight: 700; 
      margin-bottom: 10px; 
      color: var(--peche);
    }
    
    .mode-btn .desc { 
      font-size: 1em; 
      opacity: 0.85; 
      line-height: 1.5; 
    }
    
    .choice-btn {
      background: rgba(255,255,255,0.12);
      color: white;
      display: inline-block;
      min-width: 200px;
    }
    
    .choice-btn.active, .choice-btn:hover:not(:disabled) {
      background: linear-gradient(45deg, var(--rose), var(--peche));
    }
    
    .progress-bar {
      height: 10px;
      background: rgba(255,255,255,0.1);
      border-radius: 5px;
      margin: 24px 0;
      overflow: hidden;
    }
    
    .progress-fill {
      height: 100%;
      width: 0%;
      background: linear-gradient(90deg, var(--rose), var(--peche));
      transition: width 0.5s ease;
    }
    
    .question-card {
      background: rgba(255,255,255,0.08);
      padding: 20px;
      margin: 16px 0;
      border-radius: 16px;
      opacity: 0;
      transform: translateY(20px);
      animation: fadeUp 0.7s forwards;
      text-align: left;
    }
    
    @keyframes fadeUp { to { opacity:1; transform:translateY(0); } }
    
    #intimateActionText { font-size: 2em; line-height: 1.4; font-weight: 600; }
    
    footer { margin-top: 60px; color: rgba(255,255,255,0.6); font-size: 0.95em; }
    footer a { color: var(--peche); margin: 0 10px; text-decoration: none; }
    footer a:hover { color: var(--rose); }
    
    #heartsContainer { position: fixed; inset: 0; pointer-events: none; z-index: -1; overflow: hidden; }
    .heart-float { position: absolute; animation: floatHeart linear forwards; }
    @keyframes floatHeart { to { transform: translateY(-120vh) rotate(720deg); opacity: 0; } }
    
    .comparison-item { margin: 32px 0; }
    .comparison-question { font-weight: 600; margin-bottom: 12px; color: var(--peche); font-size: 1.1em; }
    .comparison-answers { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
    
    .answer-box {
      flex: 1;
      min-width: 240px;
      padding: 16px;
      border-radius: 12px;
      background: rgba(255,255,255,0.05);
    }
    
    .answer-label {
      font-weight: 600;
      margin-bottom: 8px;
      color: var(--peche);
    }
    
    .answer-correct { border: 2px solid #22c55e; background: rgba(34,197,94,0.15); }
    .answer-incorrect { border: 2px solid #ef4444; background: rgba(239,68,68,0.15); }
    
    #scoreHistory { margin: 40px 0; padding: 20px; background: rgba(255,255,255,0.05); border-radius: 16px; }
    .score-entry { margin: 10px 0; padding: 10px; background: rgba(255,255,255,0.03); border-radius: 8px; }
    
    .warning-adult {
      background: rgba(255,107,157,0.2);
      border: 2px solid var(--rose);
      padding: 16px;
      border-radius: 12px;
      margin: 20px 0;
      font-weight: 500;
    }
    
    /* STYLES MODE DISTANCE */
    .share-link-box {
      background: rgba(139, 92, 246, 0.15);
      padding: 25px;
      border-radius: 15px;
      margin: 30px 0;
      border: 2px solid var(--violet);
    }
    
    .share-link {
      background: rgba(255,255,255,0.15);
      padding: 15px;
      border-radius: 10px;
      word-break: break-all;
      font-family: monospace;
      font-size: 0.95em;
      margin: 15px 0;
      user-select: all;
      border: 1px dashed rgba(255,255,255,0.3);
    }
    
    .copy-btn {
      background: var(--violet);
      padding: 12px 30px;
      border-radius: 10px;
      border: none;
      color: white;
      cursor: pointer;
      font-weight: 600;
      transition: all 0.3s;
      font-size: 1em;
    }
    
    .copy-btn:hover {
      background: #7c3aed;
      transform: scale(1.05);
    }
    
    .waiting-screen {
      text-align: center;
      padding: 60px 20px;
    }
    
    .waiting-screen .spinner {
      width: 80px;
      height: 80px;
      border: 6px solid rgba(255,255,255,0.1);
      border-top-color: var(--rose);
      border-radius: 50%;
      animation: spin 1s linear infinite;
      margin: 30px auto;
    }
    
    @keyframes spin { to { transform: rotate(360deg); } }
    
    .mode-badge {
      display: inline-block;
      padding: 6px 15px;
      border-radius: 20px;
      font-size: 0.85em;
      font-weight: 600;
      margin-left: 10px;
    }
    
    .mode-badge.ensemble {
      background: rgba(34, 197, 94, 0.2);
      color: #22c55e;
      border: 1px solid #22c55e;
    }
    
    .mode-badge.distance {
      background: rgba(139, 92, 246, 0.2);
      color: var(--violet);
      border: 1px solid var(--violet);
    }
    
    @media (max-width: 600px) {
      .card { padding: 20px; }
      h1 { font-size: 1.8em; }
      .choice-btn { min-width: 160px; font-size: 0.95em; }
      .answer-box { min-width: 100%; }
      .mode-btn { padding: 20px; max-width: 100%; }
      .mode-btn .icon { font-size: 2.5em; }
      .mode-btn .title { font-size: 1.2em; }
    }
  </style>
</head>
<body>

<div id="heartsContainer"></div>
  <!-- ============================================================================ -->
<!-- MODULE 2 : HTML BODY (TOUS LES √âCRANS)                                   -->
<!-- ============================================================================ -->

<!-- √âCRAN 0 : Choix du Mode (NOUVEAU) -->
<div id="modeChoiceScreen" class="card">
  <h1>Jeu d'Actions Intimes üî•</h1>
  <div class="warning-adult">‚ö†Ô∏è R√©serv√© aux adultes (+18 ans) ‚ö†Ô∏è</div>
  <h2 style="margin-top: 30px;">Comment voulez-vous jouer ?</h2>
  
  <button class="mode-btn" onclick="selectMode('ensemble')">
    <span class="icon">üë´</span>
    <div class="title">Mode Ensemble</div>
    <div class="desc">Vous √™tes physiquement ensemble. Passez-vous le t√©l√©phone pour r√©pondre chacun votre tour.</div>
  </button>
  
  <button class="mode-btn" onclick="selectMode('distance')">
    <span class="icon">üì±</span>
    <div class="title">Mode √Ä Distance</div>
    <div class="desc">Vous √™tes s√©par√©s. Chacun joue de son c√¥t√©, puis vous d√©couvrez vos r√©sultats ensemble !</div>
  </button>
</div>

<!-- √âCRAN 1 : Choix du niveau de questions -->
<div id="questionCountScreen" class="card hidden">
  <h1>Jeu d'Actions Intimes üî• <span id="modeBadge"></span></h1>
  <p style="margin:20px 0; opacity:0.9;">Testez votre complicit√© de couple</p>
  <h2>Choisis le niveau de profondeur</h2>

  <button class="choice-btn" onclick="selectQuestionCount(20)">D√©butant<br><small>20 questions</small></button>
  <button class="choice-btn" onclick="selectQuestionCount(50)">Interm√©diaire<br><small>50 questions</small></button>
  <button class="choice-btn" onclick="selectQuestionCount(100)">Avanc√©<br><small>100 questions</small></button>
  <button class="choice-btn" onclick="selectQuestionCount(200)">Extr√™me<br><small>Toutes les 200</small></button>

  <div id="scoreHistory">
    <h3 style="margin-bottom:16px; color:#ff8fab;">üìä Historique r√©cent</h3>
    <div id="historyList"></div>
  </div>
  
  <button class="btn btn-secondary" onclick="backToModeChoice()">‚Üê Changer de mode</button>
</div>

<!-- √âCRAN 2 : Noms (Mode Ensemble) -->
<div id="welcomeScreen" class="card hidden">
  <h1>Pr√™ts √† tester votre complicit√© ? üíï</h1>
  <p style="margin:20px 0; opacity:0.8;">Entrez vos pr√©noms pour commencer</p>
  <input type="text" id="partner1Name" placeholder="Pr√©nom partenaire 1" autocomplete="off" maxlength="30">
  <input type="text" id="partner2Name" placeholder="Pr√©nom partenaire 2" autocomplete="off" maxlength="30">
  <button class="btn btn-primary" onclick="startQuiz()">Commencer le quiz üî•</button>
  <button class="btn btn-secondary" onclick="backToLevelChoice()">‚Üê Retour</button>
</div>

<!-- √âCRAN 2B : Noms (Mode Distance - Partenaire 1) -->
<div id="distanceWelcomeScreen" class="card hidden">
  <h1>Mode √Ä Distance üì±</h1>
  <p style="margin:20px 0; opacity:0.8;">Entrez vos pr√©noms</p>
  <input type="text" id="distancePartner1Name" placeholder="Ton pr√©nom" autocomplete="off" maxlength="30">
  <input type="text" id="distancePartner2Name" placeholder="Pr√©nom de ton partenaire" autocomplete="off" maxlength="30">
  <p style="margin:20px 0; font-size:0.9em; opacity:0.7;">
    üí° Tu vas r√©pondre aux questions, puis tu enverras un lien √† ton partenaire pour qu'il/elle r√©ponde aussi.
  </p>
  <button class="btn btn-primary" onclick="startDistanceQuiz()">Commencer üî•</button>
  <button class="btn btn-secondary" onclick="backToLevelChoice()">‚Üê Retour</button>
</div>

<!-- √âCRAN 2C : Rejoindre une session (Mode Distance - Partenaire 2) -->
<div id="joinSessionScreen" class="card hidden">
  <h1>Rejoindre une session üíï</h1>
  <div id="sessionInfo" style="margin: 30px 0;"></div>
  <button class="btn btn-primary" id="joinSessionBtn" onclick="joinSession()">R√©pondre aux questions üî•</button>
  <button class="btn btn-secondary" onclick="location.reload()">Annuler</button>
</div>

<!-- √âCRAN 3 : Quiz 1 (Mode Ensemble) -->
<div id="quiz1Screen" class="card hidden">
  <h2 id="quiz1Title"></h2>
  <div class="progress-bar"><div id="progress1" class="progress-fill"></div></div>
  <p style="opacity:0.7; margin-bottom:20px;" id="progress1Text">0% compl√©t√©</p>
  <div id="questions1Container"></div>
  <button class="btn btn-primary" id="submit1Btn" onclick="submitQuiz1()" disabled>Valider mes r√©ponses ‚Üí</button>
  <button class="btn btn-secondary" onclick="confirmQuit()">Abandonner</button>
</div>

<!-- √âCRAN 3B : Quiz Distance (Partenaire 1 ou 2) -->
<div id="distanceQuizScreen" class="card hidden">
  <h2 id="distanceQuizTitle"></h2>
  <div class="progress-bar"><div id="distanceProgress" class="progress-fill"></div></div>
  <p style="opacity:0.7; margin-bottom:20px;" id="distanceProgressText">0% compl√©t√©</p>
  <div id="distanceQuestionsContainer"></div>
  <button class="btn btn-primary" id="submitDistanceBtn" onclick="submitDistanceQuiz()" disabled>Valider mes r√©ponses ‚Üí</button>
  <button class="btn btn-secondary" onclick="confirmQuit()">Abandonner</button>
</div>

<!-- √âCRAN 4 : Lien de partage (Mode Distance - Apr√®s r√©ponses Partenaire 1) -->
<div id="shareLinkScreen" class="card hidden">
  <h1>Parfait ! üéâ</h1>
  <p style="font-size:1.2em; margin:20px 0;">Tu as termin√© ! Maintenant, envoie ce lien √† <strong id="partnerNameToShare"></strong> :</p>
  
  <div class="share-link-box">
    <h3 style="margin-bottom:15px; color:var(--violet);">üîó Lien √† partager</h3>
    <div class="share-link" id="shareLink"></div>
    <button class="copy-btn" onclick="copyShareLink()">üìã Copier le lien</button>
  </div>
  
  <p style="margin:30px 0; opacity:0.8;">
    üí° Tu peux partager ce lien par WhatsApp, SMS, email, etc.<br>
    Les r√©sultats s'afficheront quand ton partenaire aura termin√© !
  </p>
  
  <div id="waitingForPartner" class="waiting-screen hidden">
    <h3>‚è≥ En attente de <span id="waitingPartnerName"></span>...</h3>
    <div class="spinner"></div>
    <p style="opacity:0.7;">Cette page se mettra √† jour automatiquement quand ton partenaire aura fini.</p>
    <button class="btn btn-secondary" onclick="checkSessionStatus()" style="margin-top:20px;">üîÑ V√©rifier maintenant</button>
  </div>
</div>

<!-- √âCRAN 5 : Transition (Mode Ensemble seulement) -->
<div id="transitionScreen" class="card hidden">
  <h2 id="transitionMessage"></h2>
  <p style="margin:20px 0; opacity:0.8;">Passe le t√©l√©phone √† ton partenaire üì±</p>
  <button class="btn btn-primary" onclick="startQuiz2()">C'est parti ! üíñ</button>
</div>

<!-- √âCRAN 6 : Quiz 2 (Mode Ensemble seulement) -->
<div id="quiz2Screen" class="card hidden">
  <h2 id="quiz2Title"></h2>
  <div class="progress-bar"><div id="progress2" class="progress-fill"></div></div>
  <p style="opacity:0.7; margin-bottom:20px;" id="progress2Text">0% compl√©t√©</p>
  <div id="questions2Container"></div>
  <button class="btn btn-primary" id="submit2Btn" onclick="submitQuiz2()" disabled>Voir nos r√©sultats üíû</button>
  <button class="btn btn-secondary" onclick="confirmQuit()">Abandonner</button>
</div>

<!-- √âCRAN 7 : R√©sultats -->
<div id="resultsScreen" class="card hidden">
  <h1>Votre score de complicit√©</h1>
  <div style="font-size:6em; font-weight:700; color:var(--peche); margin:30px 0;" id="scoreDisplay">0%</div>
  <p id="resultMessage" style="font-size:1.5em; margin:20px 0;"></p>
  <div id="scoreBreakdown" style="margin:30px 0; padding:20px; background:rgba(255,255,255,0.05); border-radius:12px;"></div>

  <div id="bonusGameOffer" class="hidden" style="margin:50px 0;">
    <h2>üòè Mode Intime Accessible ! üòè</h2>
    <p style="margin:15px 0;">Votre complicit√© est suffisante pour tenter les 10 actions intimes‚Ä¶ Pr√™ts ?</p>
    <div id="intimateTypeChoice"></div>
  </div>

  <div id="comparisonContainer"></div>

  <button class="btn btn-primary" onclick="restartWithLevelChoice()" style="margin:30px 0;">
    Recommencer avec un autre niveau
  </button>
  <button class="btn btn-secondary" onclick="restart()">Rejouer (m√™me niveau)</button>
</div>

<!-- √âCRAN 8 : Jeu intime -->
<div id="intimateGameScreen" class="card hidden">
  <h1>Jeu d'Actions Intimes üî•</h1>
  <div class="warning-adult">R√©serv√© aux adultes (+18 ans)</div>
  <p id="intimateTypeLabel" style="margin:20px 0; font-size:1.1em; color:var(--peche);"></p>

  <div style="margin:40px 0;">
    <div style="background: linear-gradient(135deg, rgba(40,20,60,0.8), rgba(139,92,246,0.6)); padding:50px 30px; border-radius:24px; border:3px solid var(--rose); min-height:300px; display:flex; align-items:center; justify-content:center; box-shadow:0 20px 60px rgba(255,107,157,0.3);">
      <p id="intimateActionText" style="font-size:2.1em; line-height:1.45; font-weight:600;"></p>
    </div>
    <p style="margin-top:30px; font-size:1.3em; color:#ffb3d9;">
      Action <span id="actionCounter">1</span> / 10
    </p>
  </div>

  <button class="btn btn-primary" onclick="nextIntimateAction()">Action suivante üî•</button>
  <button class="btn btn-secondary" onclick="endIntimateGame()" style="margin-top:20px;">Terminer le jeu</button>
</div>

<!-- FOOTER -->
<footer>
  <div style="margin:20px 0;">‚ú® Cr√©√© avec üíï par Miracle LOHOUNME ‚ú®</div>
  <div>
    <a href="https://wa.me/22990821282" target="_blank" rel="noopener noreferrer">WhatsApp</a> ‚Ä¢
    <a href="https://www.facebook.com/Miracle.lohw" target="_blank" rel="noopener noreferrer">Facebook</a> ‚Ä¢
    <a href="https://miracle-do.github.io/mon-site/" target="_blank" rel="noopener noreferrer">Portfolio</a>
  </div>
</footer>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-firestore-compat.js"></script>

<!-- Configuration Firebase -->
<script src="firebase-config-v2.js"></script>

<script>
// Initialiser Firebase au chargement
window.addEventListener('load', () => {
  initializeFirebase();
  detectSessionFromURL();
});
  // ============================================================================
// MODULE 3 : DONN√âES (QUESTIONS + ACTIONS INTIMES)
// ============================================================================

// COLLEZ TOUTES LES 200 QUESTIONS ICI (celles du fichier original)
// Pour gagner de la place, je mets juste les premi√®res et derni√®res

const allQuestions = [
  // 1-30 l√©ger (intensit√© 1)
  {id:1,text:"Quelle est ta couleur pr√©f√©r√©e ?",about:"self",intensity:1},
  {id:2,text:"Quelle est la couleur pr√©f√©r√©e de ton partenaire ?",about:"partner",intensity:1},
  {id:3,text:"Quel est ton plat pr√©f√©r√© ?",about:"self",intensity:1},
  {id:4,text:"Quel est le plat pr√©f√©r√© de ton partenaire ?",about:"partner",intensity:1},
  {id:5,text:"O√π s'est d√©roul√© votre premier rendez-vous ?",about:"both",intensity:1},
  {id:6,text:"Quelle est ta plus grande peur ?",about:"self",intensity:1},
  {id:7,text:"Quelle est la plus grande peur de ton partenaire ?",about:"partner",intensity:1},
  {id:8,text:"Si tu pouvais avoir un super-pouvoir, ce serait lequel ?",about:"self",intensity:1},
  {id:9,text:"Quel super-pouvoir ton partenaire choisirait-il/elle ?",about:"partner",intensity:1},
  {id:10,text:"Quelle est ta destination de vacances de r√™ve ?",about:"self",intensity:1},
  {id:11,text:"Quelle est la destination de vacances de r√™ve de ton partenaire ?",about:"partner",intensity:1},
  {id:12,text:"Quel est ton film/s√©rie pr√©f√©r√©(e) ?",about:"self",intensity:1},
  {id:13,text:"Quel est le film/s√©rie pr√©f√©r√©(e) de ton partenaire ?",about:"partner",intensity:1},
  {id:14,text:"Si vous deviez adopter un animal ensemble, ce serait quoi ?",about:"both",intensity:1},
  {id:15,text:"Quelle est ta chanson pr√©f√©r√©e en ce moment ?",about:"self",intensity:1},
  {id:16,text:"Quelle chanson ton partenaire √©coute-t-il/elle en boucle ?",about:"partner",intensity:1},
  {id:17,text:"Quel est ton hobby favori ?",about:"self",intensity:1},
  {id:18,text:"Quel est le hobby pr√©f√©r√© de ton partenaire ?",about:"partner",intensity:1},
  {id:19,text:"Quelle est ta saison pr√©f√©r√©e ?",about:"self",intensity:1},
  {id:20,text:"Quelle saison ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:1},
  {id:21,text:"Quel est ton dessert favori ?",about:"self",intensity:1},
  {id:22,text:"Quel dessert ton partenaire adore-t-il/elle ?",about:"partner",intensity:1},
  {id:23,text:"Quelle est ta mati√®re scolaire pr√©f√©r√©e (ou √©tait) ?",about:"self",intensity:1},
  {id:24,text:"Quelle mati√®re ton partenaire aimait √† l'√©cole ?",about:"partner",intensity:1},
  {id:25,text:"Quel sport pr√©f√®res-tu regarder ?",about:"self",intensity:1},
  {id:26,text:"Quel sport ton partenaire aime regarder ?",about:"partner",intensity:1},
  {id:27,text:"Quelle est ta boisson pr√©f√©r√©e ?",about:"self",intensity:1},
  {id:28,text:"Quelle boisson ton partenaire commande souvent ?",about:"partner",intensity:1},
  {id:29,text:"Dans quelle ville aimerais-tu vivre ?",about:"self",intensity:1},
  {id:30,text:"Dans quelle ville ton partenaire aimerait vivre ?",about:"partner",intensity:1},

  // 31-80 moyen (intensit√© 2)
  {id:31,text:"Quel est ton plus beau souvenir ensemble ?",about:"both",intensity:2},
  {id:32,text:"Qu'est-ce qui t'a attir√© la premi√®re fois chez ton partenaire ?",about:"self",intensity:2},
  {id:33,text:"Qu'est-ce qui a attir√© ton partenaire chez toi la premi√®re fois ?",about:"partner",intensity:2},
  {id:34,text:"Quelle est ta plus grande qualit√© selon toi ?",about:"self",intensity:2},
  {id:35,text:"Quelle est la plus grande qualit√© de ton partenaire ?",about:"partner",intensity:2},
  {id:36,text:"Quel est ton plus grand d√©faut ?",about:"self",intensity:2},
  {id:37,text:"Quel est le plus grand d√©faut de ton partenaire ?",about:"partner",intensity:2},
  {id:38,text:"Quelle est ta plus grande fiert√© dans la vie ?",about:"self",intensity:2},
  {id:39,text:"De quoi ton partenaire est-il/elle le plus fier/fi√®re ?",about:"partner",intensity:2},
  {id:40,text:"Quel est ton r√™ve le plus fou ?",about:"self",intensity:2},
  {id:41,text:"Quel est le r√™ve le plus fou de ton partenaire ?",about:"partner",intensity:2},
  {id:42,text:"Quelle est ta plus grande r√©ussite ?",about:"self",intensity:2},
  {id:43,text:"Quelle est la plus grande r√©ussite de ton partenaire ?",about:"partner",intensity:2},
  {id:44,text:"Quel est ton souvenir d'enfance pr√©f√©r√© ?",about:"self",intensity:2},
  {id:45,text:"Quel est le souvenir d'enfance pr√©f√©r√© de ton partenaire ?",about:"partner",intensity:2},
  {id:46,text:"Quelle est la chose que tu admires le plus chez ton partenaire ?",about:"self",intensity:2},
  {id:47,text:"Quelle chose ton partenaire admire-t-il/elle le plus chez toi ?",about:"partner",intensity:2},
  {id:48,text:"Quel est ton plus grand regret ?",about:"self",intensity:2},
  {id:49,text:"Quel est le plus grand regret de ton partenaire ?",about:"partner",intensity:2},
  {id:50,text:"Quelle est ta plus grande phobie ?",about:"self",intensity:2},
  {id:51,text:"Quelle est la phobie de ton partenaire ?",about:"partner",intensity:2},
  {id:52,text:"Quel est ton moment pr√©f√©r√© de la journ√©e ?",about:"self",intensity:2},
  {id:53,text:"Quel moment de la journ√©e ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:2},
  {id:54,text:"Quelle est ta citation ou phrase pr√©f√©r√©e ?",about:"self",intensity:2},
  {id:55,text:"Quelle citation ton partenaire aime-t-il/elle ?",about:"partner",intensity:2},
  {id:56,text:"Quel est ton parfum ou odeur pr√©f√©r√©(e) ?",about:"self",intensity:2},
  {id:57,text:"Quel parfum ou odeur ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:2},
  {id:58,text:"Quelle est ta plus grande ambition ?",about:"self",intensity:2},
  {id:59,text:"Quelle est la plus grande ambition de ton partenaire ?",about:"partner",intensity:2},
  {id:60,text:"Si tu pouvais rencontrer quelqu'un (vivant ou mort), qui ce serait ?",about:"self",intensity:2},
  {id:61,text:"Qui ton partenaire aimerait-il/elle rencontrer ?",about:"partner",intensity:2},
  {id:62,text:"Quel est ton talent cach√© ?",about:"self",intensity:2},
  {id:63,text:"Quel est le talent cach√© de ton partenaire ?",about:"partner",intensity:2},
  {id:64,text:"Quelle est ta plus grande ins√©curit√© ?",about:"self",intensity:2},
  {id:65,text:"Quelle est la plus grande ins√©curit√© de ton partenaire ?",about:"partner",intensity:2},
  {id:66,text:"Quel est ton style vestimentaire pr√©f√©r√© ?",about:"self",intensity:2},
  {id:67,text:"Quel style vestimentaire ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:2},
  {id:68,text:"Quelle est ta fa√ßon pr√©f√©r√©e de te d√©tendre ?",about:"self",intensity:2},
  {id:69,text:"Comment ton partenaire pr√©f√®re-t-il/elle se d√©tendre ?",about:"partner",intensity:2},
  {id:70,text:"Quel est ton type de musique pr√©f√©r√© ?",about:"self",intensity:2},
  {id:71,text:"Quel type de musique ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:2},
  {id:72,text:"Quelle est ta p√©riode historique pr√©f√©r√©e ?",about:"self",intensity:2},
  {id:73,text:"Quelle p√©riode historique fascine ton partenaire ?",about:"partner",intensity:2},
  {id:74,text:"Quel est ton plat r√©confort absolu ?",about:"self",intensity:2},
  {id:75,text:"Quel est le plat r√©confort de ton partenaire ?",about:"partner",intensity:2},
  {id:76,text:"Quelle est ta routine matinale id√©ale ?",about:"self",intensity:2},
  {id:77,text:"Quelle est la routine matinale id√©ale de ton partenaire ?",about:"partner",intensity:2},
  {id:78,text:"Quel est ton moyen de transport pr√©f√©r√© ?",about:"self",intensity:2},
  {id:79,text:"Quel moyen de transport ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:2},
  {id:80,text:"Quelle est votre tradition de couple pr√©f√©r√©e ?",about:"both",intensity:2},

  // 81-150 avanc√© (intensit√© 2-3)
  {id:81,text:"Quelle est ta plus grande faiblesse en amour ?",about:"self",intensity:2},
  {id:82,text:"Quelle est la plus grande faiblesse de ton partenaire en amour ?",about:"partner",intensity:2},
  {id:83,text:"Quel est ton langage d'amour principal ?",about:"self",intensity:2},
  {id:84,text:"Quel est le langage d'amour principal de ton partenaire ?",about:"partner",intensity:2},
  {id:85,text:"Quelle est ta vision de la relation id√©ale ?",about:"self",intensity:2},
  {id:86,text:"Quelle est la vision de ton partenaire d'une relation id√©ale ?",about:"partner",intensity:2},
  {id:87,text:"Combien d'enfants souhaites-tu avoir (ou en as-tu) ?",about:"self",intensity:2},
  {id:88,text:"Combien d'enfants ton partenaire souhaite-t-il/elle avoir ?",about:"partner",intensity:2},
  {id:89,text:"Quelle est ta plus grande valeur dans la vie ?",about:"self",intensity:2},
  {id:90,text:"Quelle est la plus grande valeur de ton partenaire ?",about:"partner",intensity:2},
  {id:91,text:"Quel est ton plus grand turn-on (ce qui t'attire) ?",about:"self",intensity:3},
  {id:92,text:"Quel est le plus grand turn-on de ton partenaire ?",about:"partner",intensity:3},
  {id:93,text:"Quel est ton plus grand turn-off (ce qui te repousse) ?",about:"self",intensity:3},
  {id:94,text:"Quel est le plus grand turn-off de ton partenaire ?",about:"partner",intensity:3},
  {id:95,text:"Quelle partie du corps de ton partenaire pr√©f√®res-tu ?",about:"self",intensity:3},
  {id:96,text:"Quelle partie de ton corps ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:3},
  {id:97,text:"Quelle est ta position sexuelle pr√©f√©r√©e ?",about:"self",intensity:3},
  {id:98,text:"Quelle est la position sexuelle pr√©f√©r√©e de ton partenaire ?",about:"partner",intensity:3},
  {id:99,text:"Quel est ton fantasme le plus secret ?",about:"self",intensity:3},
  {id:100,text:"Quel est le fantasme le plus secret de ton partenaire ?",about:"partner",intensity:3},
  {id:101,text:"Quelle est ta zone √©rog√®ne pr√©f√©r√©e ?",about:"self",intensity:3},
  {id:102,text:"Quelle est la zone √©rog√®ne pr√©f√©r√©e de ton partenaire ?",about:"partner",intensity:3},
  {id:103,text:"Quel moment de la journ√©e pr√©f√®res-tu pour l'intimit√© ?",about:"self",intensity:3},
  {id:104,text:"Quel moment ton partenaire pr√©f√®re-t-il/elle pour l'intimit√© ?",about:"partner",intensity:3},
  {id:105,text:"Quelle est l'endroit le plus fou o√π vous avez fait l'amour ?",about:"both",intensity:3},
  {id:106,text:"Quel type de pr√©liminaires pr√©f√®res-tu ?",about:"self",intensity:3},
  {id:107,text:"Quel type de pr√©liminaires ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:3},
  {id:108,text:"Quelle lingerie ton partenaire trouve-t-il/elle la plus sexy ?",about:"partner",intensity:3},
  {id:109,text:"Quel type de lingerie trouves-tu la plus sexy ?",about:"self",intensity:3},
  {id:110,text:"Quelle est ta fr√©quence id√©ale pour l'intimit√© ?",about:"self",intensity:3},
  {id:111,text:"Quelle est la fr√©quence id√©ale de ton partenaire pour l'intimit√© ?",about:"partner",intensity:3},
  {id:112,text:"Aimes-tu les jeux de r√¥le ? Si oui, lesquels ?",about:"self",intensity:3},
  {id:113,text:"Ton partenaire aime-t-il/elle les jeux de r√¥le ? Lesquels ?",about:"partner",intensity:3},
  {id:114,text:"Quelle est ta limite absolue en intimit√© (ce que tu ne ferais jamais) ?",about:"self",intensity:3},
  {id:115,text:"Quelle est la limite absolue de ton partenaire en intimit√© ?",about:"partner",intensity:3},
  {id:116,text:"Pr√©f√®res-tu √™tre dominant(e) ou soumis(e) ?",about:"self",intensity:3},
  {id:117,text:"Ton partenaire pr√©f√®re-t-il/elle √™tre dominant(e) ou soumis(e) ?",about:"partner",intensity:3},
  {id:118,text:"Quelle est ta phrase ou mot pr√©f√©r√©(e) √† entendre au lit ?",about:"self",intensity:3},
  {id:119,text:"Quelle phrase ou mot ton partenaire aime-t-il/elle entendre au lit ?",about:"partner",intensity:3},
  {id:120,text:"Quelle est ton ambiance id√©ale pour l'intimit√© (musique, bougies, etc.) ?",about:"self",intensity:3},
  {id:121,text:"Quelle ambiance ton partenaire pr√©f√®re-t-il/elle pour l'intimit√© ?",about:"partner",intensity:3},
  {id:122,text:"As-tu d√©j√† utilis√© des jouets intimes ? Lesquels ?",about:"self",intensity:3},
  {id:123,text:"Ton partenaire a-t-il/elle d√©j√† utilis√© des jouets intimes ? Lesquels ?",about:"partner",intensity:3},
  {id:124,text:"Quelle est ta dur√©e id√©ale pour un rapport intime ?",about:"self",intensity:3},
  {id:125,text:"Quelle est la dur√©e id√©ale de ton partenaire pour un rapport ?",about:"partner",intensity:3},
  {id:126,text:"Pr√©f√®res-tu le sexe doux et romantique ou plus intense ?",about:"self",intensity:3},
  {id:127,text:"Ton partenaire pr√©f√®re-t-il/elle le sexe doux ou intense ?",about:"partner",intensity:3},
  {id:128,text:"Quel film ou s√©rie √©rotique vous a le plus excit√©(e)s ?",about:"both",intensity:3},
  {id:129,text:"Quelle partie du corps aimes-tu qu'on embrasse en premier ?",about:"self",intensity:3},
  {id:130,text:"Quelle partie du corps ton partenaire aime-t-il/elle qu'on embrasse d'abord ?",about:"partner",intensity:3},
  {id:131,text:"Quelle est ta technique de s√©duction pr√©f√©r√©e ?",about:"self",intensity:2},
  {id:132,text:"Quelle est la technique de s√©duction pr√©f√©r√©e de ton partenaire ?",about:"partner",intensity:2},
  {id:133,text:"Quel compliment aimes-tu le plus recevoir ?",about:"self",intensity:2},
  {id:134,text:"Quel compliment ton partenaire aime-t-il/elle le plus recevoir ?",about:"partner",intensity:2},
  {id:135,text:"Quelle surprise romantique t'a le plus marqu√©(e) ?",about:"self",intensity:2},
  {id:136,text:"Quelle surprise romantique a le plus marqu√© ton partenaire ?",about:"partner",intensity:2},
  {id:137,text:"Quelle est ta date parfaite ?",about:"self",intensity:2},
  {id:138,text:"Quelle est la date parfaite selon ton partenaire ?",about:"partner",intensity:2},
  {id:139,text:"Quel cadeau t'a fait le plus plaisir de la part de ton partenaire ?",about:"self",intensity:2},
  {id:140,text:"Quel cadeau a fait le plus plaisir √† ton partenaire de ta part ?",about:"partner",intensity:2},
  {id:141,text:"Quelle chanson repr√©sente le mieux votre relation ?",about:"both",intensity:2},
  {id:142,text:"Quel surnom affectueux ton partenaire pr√©f√®re-t-il/elle ?",about:"partner",intensity:2},
  {id:143,text:"Quel surnom affectueux pr√©f√®res-tu ?",about:"self",intensity:2},
  {id:144,text:"Quelle est ta conception du romantisme ?",about:"self",intensity:2},
  {id:145,text:"Quelle est la conception du romantisme de ton partenaire ?",about:"partner",intensity:2},
  {id:146,text:"Quelle activit√© aimes-tu faire √† deux ?",about:"self",intensity:2},
  {id:147,text:"Quelle activit√© ton partenaire aime-t-il/elle faire √† deux ?",about:"partner",intensity:2},
  {id:148,text:"Quelle est ta fa√ßon pr√©f√©r√©e de dire 'je t'aime' ?",about:"self",intensity:2},
  {id:149,text:"Quelle est la fa√ßon pr√©f√©r√©e de ton partenaire de dire 'je t'aime' ?",about:"partner",intensity:2},
  {id:150,text:"Quel est votre endroit secret pr√©f√©r√© ?",about:"both",intensity:2},
// 151-200 extr√™me (intensit√© 3)
  {id:151,text:"Quelle est ta plus grande insatisfaction dans votre vie intime ?",about:"self",intensity:3},
  {id:152,text:"Quelle est la plus grande insatisfaction de ton partenaire dans votre vie intime ?",about:"partner",intensity:3},
  {id:153,text:"As-tu d√©j√† fantasm√© sur quelqu'un d'autre ? Qui ?",about:"self",intensity:3},
  {id:154,text:"Ton partenaire a-t-il/elle d√©j√† fantasm√© sur quelqu'un d'autre ?",about:"partner",intensity:3},
  {id:155,text:"Quelle est la chose la plus os√©e que tu aimerais essayer ?",about:"self",intensity:3},
  {id:156,text:"Quelle est la chose la plus os√©e que ton partenaire aimerait essayer ?",about:"partner",intensity:3},
  {id:157,text:"Quelle partie de ton corps es-tu le plus complex√©(e) ?",about:"self",intensity:3},
  {id:158,text:"De quelle partie de son corps ton partenaire est-il/elle le plus complex√©(e) ?",about:"partner",intensity:3},
  {id:159,text:"As-tu d√©j√† fait semblant de jouir ?",about:"self",intensity:3},
  {id:160,text:"Ton partenaire a-t-il/elle d√©j√† fait semblant de jouir ?",about:"partner",intensity:3},
  {id:161,text:"Quelle est ta plus grande frustration sexuelle ?",about:"self",intensity:3},
  {id:162,text:"Quelle est la plus grande frustration sexuelle de ton partenaire ?",about:"partner",intensity:3},
  {id:163,text:"Aimerais-tu essayer quelque chose de nouveau au lit ? Quoi ?",about:"self",intensity:3},
  {id:164,text:"Ton partenaire aimerait-il/elle essayer quelque chose de nouveau ? Quoi ?",about:"partner",intensity:3},
  {id:165,text:"Quelle est ta plus grande crainte concernant votre relation ?",about:"self",intensity:3},
  {id:166,text:"Quelle est la plus grande crainte de ton partenaire concernant votre relation ?",about:"partner",intensity:3},
  {id:167,text:"Que changerais-tu dans votre vie de couple ?",about:"self",intensity:3},
  {id:168,text:"Que ton partenaire changerait-il/elle dans votre vie de couple ?",about:"partner",intensity:3},
  {id:169,text:"Quelle est ton exp√©rience sexuelle la plus m√©morable ?",about:"self",intensity:3},
  {id:170,text:"Quelle est l'exp√©rience sexuelle la plus m√©morable de ton partenaire ?",about:"partner",intensity:3},
  {id:171,text:"As-tu d√©j√† eu une aventure d'un soir ? Combien ?",about:"self",intensity:3},
  {id:172,text:"Ton partenaire a-t-il/elle d√©j√† eu une aventure d'un soir ? Combien ?",about:"partner",intensity:3},
  {id:173,text:"Quel est ton nombre de partenaires sexuels ?",about:"self",intensity:3},
  {id:174,text:"Quel est le nombre de partenaires sexuels de ton partenaire ?",about:"partner",intensity:3},
  {id:175,text:"Quelle est ta position sur la fid√©lit√© absolue ?",about:"self",intensity:3},
  {id:176,text:"Quelle est la position de ton partenaire sur la fid√©lit√© absolue ?",about:"partner",intensity:3},
  {id:177,text:"Serais-tu ouvert(e) √† un plan √† trois ?",about:"self",intensity:3},
  {id:178,text:"Ton partenaire serait-il/elle ouvert(e) √† un plan √† trois ?",about:"partner",intensity:3},
  {id:179,text:"Quelle est ta plus grande jalousie ?",about:"self",intensity:3},
  {id:180,text:"Quelle est la plus grande jalousie de ton partenaire ?",about:"partner",intensity:3},
  {id:181,text:"As-tu d√©j√† tromp√© quelqu'un ?",about:"self",intensity:3},
  {id:182,text:"Ton partenaire a-t-il/elle d√©j√† tromp√© quelqu'un ?",about:"partner",intensity:3},
  {id:183,text:"Quelle est la chose la plus g√™nante qui te soit arriv√©e au lit ?",about:"self",intensity:3},
  {id:184,text:"Quelle est la chose la plus g√™nante arriv√©e √† ton partenaire au lit ?",about:"partner",intensity:3},
  {id:185,text:"Quelle partie de ton pass√© sexuel pr√©f√©rerais-tu cacher ?",about:"self",intensity:3},
  {id:186,text:"Quelle partie de son pass√© sexuel ton partenaire pr√©f√©rerait cacher ?",about:"partner",intensity:3},
  {id:187,text:"Quelle est ta plus grande honte sexuelle ?",about:"self",intensity:3},
  {id:188,text:"Quelle est la plus grande honte sexuelle de ton partenaire ?",about:"partner",intensity:3},
  {id:189,text:"As-tu d√©j√† menti sur ton orgasme ?",about:"self",intensity:3},
  {id:190,text:"Ton partenaire a-t-il/elle d√©j√† menti sur son orgasme ?",about:"partner",intensity:3},
  {id:191,text:"Quelle est la chose la plus kinky que tu aies faite ?",about:"self",intensity:3},
  {id:192,text:"Quelle est la chose la plus kinky que ton partenaire ait faite ?",about:"partner",intensity:3},
  {id:193,text:"Aimerais-tu √™tre film√©(e) pendant l'acte ?",about:"self",intensity:3},
  {id:194,text:"Ton partenaire aimerait-il/elle √™tre film√©(e) pendant l'acte ?",about:"partner",intensity:3},
  {id:195,text:"Quelle c√©l√©brit√© trouves-tu la plus sexy ?",about:"self",intensity:3},
  {id:196,text:"Quelle c√©l√©brit√© ton partenaire trouve-t-il/elle la plus sexy ?",about:"partner",intensity:3},
  {id:197,text:"Quelle est ta plus grande ins√©curit√© au lit ?",about:"self",intensity:3},
  {id:198,text:"Quelle est la plus grande ins√©curit√© de ton partenaire au lit ?",about:"partner",intensity:3},
  {id:199,text:"Quel est le moment le plus embarrassant de votre relation ?",about:"both",intensity:3},
  {id:200,text:"Quelle est la chose la plus √©rotique que vous ayez faite ensemble ?",about:"both",intensity:3}
];
// ACTIONS INTIMES - MODE PHYSIQUE (pour mode ensemble OU retrouvailles)
const intimateActionsPhysical = [
  "Embrasse passionn√©ment ton partenaire pendant 30 secondes sans t'arr√™ter",
  "Fais un massage sensuel du dos de ton partenaire pendant 2 minutes",
  "Chuchote √† l'oreille de ton partenaire ce que tu aimerais lui faire ce soir",
  "Caresse doucement le visage de ton partenaire en le/la regardant dans les yeux",
  "Embrasse tendrement le cou de ton partenaire pendant 1 minute",
  "Fais un strip-tease lent et sensuel pour ton partenaire",
  "Masse les pieds de ton partenaire avec de l'huile",
  "Mordille d√©licatement l'oreille de ton partenaire",
  "D√©cris en d√©tail ton fantasme pr√©f√©r√© √† ton partenaire",
  "Fais un c√¢lin enlac√© pendant 3 minutes en silence, en ressentant la chaleur de l'autre",
  "Caresse les cheveux de ton partenaire tout en l'embrassant",
  "Dessine des motifs sur le dos de ton partenaire avec tes doigts",
  "Embrasse chaque doigt de ton partenaire sensuellement",
  "Fais un massage des √©paules √† ton partenaire",
  "Murmure 3 choses que tu adores chez ton partenaire",
  "L√®che d√©licatement les l√®vres de ton partenaire",
  "Caresse l'int√©rieur des cuisses de ton partenaire",
  "Fais un bisou sur chaque partie du corps que ton partenaire d√©signe",
  "Danse un slow coll√©-serr√© avec ton partenaire",
  "Retire lentement un v√™tement de ton partenaire",
  "Souffle doucement dans le cou de ton partenaire",
  "Fais courir tes doigts sur les bras de ton partenaire",
  "Embrasse le ventre de ton partenaire tendrement",
  "Caresse le visage de ton partenaire avec une plume (ou tes cheveux)",
  "Partage un aliment en le nourrissant sensuellement √† ton partenaire",
  "Embrasse les mains de ton partenaire",
  "Fais des cercles avec tes doigts sur la nuque de ton partenaire",
  "Regarde intens√©ment ton partenaire dans les yeux pendant 1 minute sans parler",
  "Caresse doucement les hanches de ton partenaire",
  "Fais g√©mir ton partenaire avec tes caresses les plus tendres"
];

// ACTIONS INTIMES - MODE VIRTUEL (pour mode distance)
const intimateActionsVirtual = [
  "Envoie une photo de toi dans ta tenue la plus sexy (√† ton confort)",
  "Fais un strip-tease devant la webcam",
  "D√©cris en d√©tail ton fantasme pr√©f√©r√© par message vocal",
  "Montre-toi en sous-v√™tements en vid√©o",
  "Envoie un message vocal en g√©missant sensuellement",
  "Fais semblant de t'embrasser avec la cam√©ra",
  "Montre comment tu te touches (√† ton confort)",
  "D√©cris ce que tu aimerais faire √† ton partenaire en ce moment",
  "Envoie une photo suggestive (sans nudit√© compl√®te)",
  "Fais un appel vid√©o et montre ton corps lentement",
  "Murmure des mots coquins √† la cam√©ra",
  "Fais comme si tu embrassais le cou de ton partenaire face cam√©ra",
  "Envoie une vid√©o de toi en train de danser sensuellement",
  "Montre ta chambre et d√©cris ce que vous y feriez ensemble",
  "Fais des bruits sensuels pour exciter ton partenaire",
  "Envoie une photo de la partie de ton corps que tu pr√©f√®res",
  "D√©cris en d√©tail comment serait votre prochaine nuit ensemble",
  "Fais un show de 30 secondes pour exciter ton partenaire",
  "Envoie un message texte tr√®s explicite sur tes d√©sirs",
  "Montre comment tu r√©agirais √† ses caresses (mim√©)",
  "Fais semblant de mordiller ton partenaire face cam√©ra",
  "Envoie une vid√©o de toi qui t'allonges sensuellement sur le lit",
  "D√©cris ton r√™ve √©rotique le plus fou",
  "Fais des mouvements suggestifs face √† la cam√©ra",
  "Envoie une photo de toi mordu la l√®vre de fa√ßon sexy",
  "Montre comment tu te pr√©parerais pour une nuit avec lui/elle",
  "D√©cris en d√©tail ta position pr√©f√©r√©e et pourquoi",
  "Fais un compte √† rebours sensuel avant de te r√©v√©ler",
  "Envoie une vid√©o de toi chuchotant des choses coquines",
  "Promets √† ton partenaire ce que tu lui feras lors des retrouvailles"
];

// VARIABLES GLOBALES
let selectedQuestionCount = 50;
let selectedMode = ''; // 'ensemble' ou 'distance'
let questions = [];
let partner1 = "";
let partner2 = "";
let answers1 = {};
let answers2 = {};
let currentActionIndex = 0;
let activeHearts = 0;
const maxHearts = 20;
let hasPlayedIntimateActions = false;
let currentSessionId = null;
let intimateActionType = 'physical'; // 'physical' ou 'virtual'
// ============================================================================
// MODULE 4 : FONCTIONS UTILITAIRES
// ============================================================================

// √âchapper le HTML pour √©viter les injections XSS
function escapeHtml(text) {
  const div = document.createElement('div');
  div.textContent = text;
  return div.innerHTML;
}

// Confirmer avant de quitter
function confirmQuit() {
  if (confirm("Es-tu s√ªr(e) de vouloir abandonner ? Toutes les r√©ponses seront perdues.")) {
    restartWithLevelChoice();
  }
}

// M√©langer un tableau (algorithme Fisher-Yates)
function shuffleArray(array) {
  const shuffled = [...array];
  for (let i = shuffled.length - 1; i > 0; i--) {
    const j = Math.floor(Math.random() * (i + 1));
    [shuffled[i], shuffled[j]] = [shuffled[j], shuffled[i]];
  }
  return shuffled;
}

// C≈ìurs flottants anim√©s
function createFloatingHearts() {
  const container = document.getElementById('heartsContainer');
  const hearts = ['üíï','üíñ','üíó','üíì','üíù','‚ù§Ô∏è','ü•∞','üòç','üíã','üåπ'];
  
  setInterval(() => {
    if (activeHearts >= maxHearts) return;
    
    const heart = document.createElement('div');
    heart.className = 'heart-float';
    heart.textContent = hearts[Math.floor(Math.random() * hearts.length)];
    heart.style.left = Math.random() * 100 + '%';
    heart.style.bottom = '-50px';
    heart.style.animationDelay = Math.random() * 3 + 's';
    heart.style.animationDuration = (Math.random() * 12 + 10) + 's';
    heart.style.fontSize = (Math.random() * 28 + 20) + 'px';
    container.appendChild(heart);
    activeHearts++;
    
    setTimeout(() => {
      heart.remove();
      activeHearts--;
    }, 16000);
  }, 600);
}

createFloatingHearts();

// Afficher l'historique des scores
function showHistory() {
  const history = JSON.parse(localStorage.getItem('intimateGameScores') || '[]');
  const historyDiv = document.getElementById('historyList');
  
  if (history.length === 0) {
    historyDiv.innerHTML = '<em style="opacity:0.7;">Aucun historique pour le moment</em>';
    return;
  }
  
  const last3 = history.slice(-3).reverse();
  const best = history.reduce((max, entry) => entry.score > max.score ? entry : max, {score: 0});
  
  let html = '';
  
  last3.forEach((entry) => {
    const modeIcon = entry.modeJeu === 'distance' ? 'üì±' : 'üë´';
    html += `
      <div class="score-entry">
        <div><strong>${escapeHtml(entry.p1)} & ${escapeHtml(entry.p2)}</strong> ${modeIcon}</div>
        <div>Score: <strong style="color:var(--peche);">${entry.score}%</strong> ‚Ä¢ ${entry.questions} questions</div>
        <div style="font-size:0.9em;opacity:0.7;">${entry.date}</div>
      </div>
    `;
  });
  
  if (best.score > 0) {
    html += `
      <div style="margin-top:20px;padding:15px;background:rgba(255,107,157,0.2);border-radius:8px;border:2px solid var(--rose);">
        <div><strong>üèÜ Meilleur score</strong></div>
        <div style="font-size:1.3em;color:var(--peche);font-weight:700;">${best.score}%</div>
        <div style="font-size:0.9em;">${escapeHtml(best.p1)} & ${escapeHtml(best.p2)}</div>
      </div>
    `;
  }
  
  historyDiv.innerHTML = html;
}

// Sauvegarder le score dans localStorage
function saveScore(percentage, mode) {
  const entry = {
    date: new Date().toLocaleString('fr-FR'),
    p1: partner1,
    p2: partner2,
    questions: selectedQuestionCount,
    score: percentage,
    modeJeu: mode || selectedMode
  };
  
  let history = JSON.parse(localStorage.getItem('intimateGameScores') || '[]');
  history.push(entry);
  
  if (history.length > 10) {
    history = history.slice(-10);
  }
  
  localStorage.setItem('intimateGameScores', JSON.stringify(history));
}

// Gestion clavier
document.addEventListener('keydown', function(e) {
  if (e.key === 'Enter' && e.target.tagName === 'INPUT') {
    e.preventDefault();
  }
});

// Confirmation avant fermeture
window.addEventListener('beforeunload', function(e) {
  if (Object.keys(answers1).length > 0 && !document.getElementById('resultsScreen').classList.contains('hidden')) {
    return;
  }
  
  if (Object.keys(answers1).length > 0 || Object.keys(answers2).length > 0) {
    e.preventDefault();
    e.returnValue = '';
  }
});

// Charger l'historique au d√©marrage
window.addEventListener('load', showHistory);
  // ============================================================================
// MODULE 5 : MODE ENSEMBLE
// ============================================================================

function selectMode(mode) {
  selectedMode = mode;
  document.getElementById('modeChoiceScreen').classList.add('hidden');
  document.getElementById('questionCountScreen').classList.remove('hidden');
  
  const badge = document.getElementById('modeBadge');
  if (mode === 'ensemble') {
    badge.innerHTML = '<span class="mode-badge ensemble">üë´ Ensemble</span>';
  } else {
    badge.innerHTML = '<span class="mode-badge distance">üì± √Ä distance</span>';
  }
}

function backToModeChoice() {
  document.getElementById('questionCountScreen').classList.add('hidden');
  document.getElementById('modeChoiceScreen').classList.remove('hidden');
}

function selectQuestionCount(n) {
  selectedQuestionCount = n;
  document.querySelectorAll('.choice-btn').forEach(b => b.classList.remove('active'));
  event.target.classList.add('active');
  
  setTimeout(() => {
    document.getElementById('questionCountScreen').classList.add('hidden');
    
    if (selectedMode === 'ensemble') {
      document.getElementById('welcomeScreen').classList.remove('hidden');
    } else {
      document.getElementById('distanceWelcomeScreen').classList.remove('hidden');
    }
  }, 300);
}

function backToLevelChoice() {
  if (selectedMode === 'ensemble') {
    document.getElementById('welcomeScreen').classList.add('hidden');
  } else {
    document.getElementById('distanceWelcomeScreen').classList.add('hidden');
  }
  document.getElementById('questionCountScreen').classList.remove('hidden');
}

function startQuiz() {
  partner1 = document.getElementById('partner1Name').value.trim();
  partner2 = document.getElementById('partner2Name').value.trim();
  
  if (!partner1 || !partner2) {
    alert("Entre les deux pr√©noms s'il te pla√Æt üíï");
    return;
  }
  
  if (partner1.length < 2 || partner2.length < 2) {
    alert("Les pr√©noms doivent contenir au moins 2 caract√®res üíï");
    return;
  }

  questions = shuffleArray([...allQuestions]).slice(0, selectedQuestionCount);

  document.getElementById('welcomeScreen').classList.add('hidden');
  document.getElementById('quiz1Screen').classList.remove('hidden');
  document.getElementById('quiz1Title').textContent = `${partner1}, √† toi ! üíñ (${questions.length} questions)`;
  renderQuestions('questions1Container', 1);
}

function renderQuestions(containerId, quizNum) {
  const cont = document.getElementById(containerId);
  cont.innerHTML = '';
  
  questions.forEach((q, i) => {
    const d = document.createElement('div');
    d.className = 'question-card';
    d.style.animationDelay = i * 0.05 + 's';
    
    const intensityEmoji = q.intensity === 1 ? 'üå±' : q.intensity === 2 ? 'üî•' : 'üíã';
    
    d.innerHTML = `
      <div style="font-weight:600;color:var(--peche);margin-bottom:8px;">
        Question ${i + 1}/${questions.length} ${intensityEmoji}
      </div>
      <div style="margin:12px 0;font-size:1.05em;">${escapeHtml(q.text)}</div>
      <input 
        type="text" 
        id="q${quizNum}_${q.id}" 
        placeholder="Ta r√©ponse..." 
        oninput="updateProgress(${quizNum})"
        maxlength="200"
        autocomplete="off"
      >
    `;
    cont.appendChild(d);
  });
}

function updateProgress(quizNum) {
  let completed = 0;
  questions.forEach(q => {
    const input = document.getElementById(`q${quizNum}_${q.id}`);
    if (input?.value.trim()) completed++;
  });
  
  const percentage = Math.round((completed / questions.length) * 100);
  document.getElementById(`progress${quizNum}`).style.width = percentage + '%';
  document.getElementById(`progress${quizNum}Text`).textContent = percentage + '% compl√©t√©';
  
  const submitBtn = document.getElementById(`submit${quizNum}Btn`);
  if (submitBtn) {
    submitBtn.disabled = completed < questions.length;
  }
}

function submitQuiz1() {
  answers1 = {};
  let allAnswered = true;
  
  questions.forEach(q => {
    const value = document.getElementById(`q1_${q.id}`)?.value.trim();
    if (!value) {
      allAnswered = false;
    } else {
      answers1[q.id] = value;
    }
  });
  
  if (!allAnswered) {
    alert("R√©ponds √† toutes les questions s'il te pla√Æt üíï");
    return;
  }

  document.getElementById('quiz1Screen').classList.add('hidden');
  document.getElementById('transitionScreen').classList.remove('hidden');
  document.getElementById('transitionMessage').textContent = `${partner1} a termin√© ! ${partner2}, √† ton tour ! üíñ`;
}

function startQuiz2() {
  document.getElementById('transitionScreen').classList.add('hidden');
  document.getElementById('quiz2Screen').classList.remove('hidden');
  document.getElementById('quiz2Title').textContent = `${partner2}, √† toi ! üíñ (${questions.length} questions)`;
  renderQuestions('questions2Container', 2);
}

function submitQuiz2() {
  answers2 = {};
  let allAnswered = true;
  
  questions.forEach(q => {
    const value = document.getElementById(`q2_${q.id}`)?.value.trim();
    if (!value) {
      allAnswered = false;
    } else {
      answers2[q.id] = value;
    }
  });
  
  if (!allAnswered) {
    alert("R√©ponds √† toutes les questions s'il te pla√Æt üíï");
    return;
  }
  
  calculateResults();
  }
  // ============================================================================
// MODULE 6 : MODE DISTANCE
// ============================================================================

function detectSessionFromURL() {
  const urlParams = new URLSearchParams(window.location.search);
  const sessionId = urlParams.get('session');
  
  if (sessionId) {
    loadExistingSession(sessionId);
  }
}

async function loadExistingSession(sessionId) {
  const session = await getDistanceSession(sessionId);
  
  if (!session) {
    alert("Session non trouv√©e ou expir√©e");
    return;
  }
  
  if (session.expired) {
    alert("Cette session a expir√© (plus de 72h). Cr√©ez une nouvelle partie !");
    return;
  }
  
  if (session.statut === 'complete') {
    // Les deux ont jou√©, afficher les r√©sultats
    loadSessionResults(session);
    return;
  }
  
  // Partenaire 2 arrive pour jouer
  currentSessionId = sessionId;
  partner1 = session.partenaire1;
  partner2 = session.partenaire2;
  questions = allQuestions.filter(q => session.questions.includes(q.id));
  selectedQuestionCount = session.nombreQuestions;
  selectedMode = 'distance';
  
  document.getElementById('modeChoiceScreen').classList.add('hidden');
  document.getElementById('joinSessionScreen').classList.remove('hidden');
  
  document.getElementById('sessionInfo').innerHTML = `
    <div style="font-size:1.2em; line-height:1.6;">
      <p style="margin:15px 0;">
        <strong style="color:var(--peche);">${escapeHtml(session.partenaire1)}</strong> 
        attend tes r√©ponses ! ‚ù§Ô∏è
      </p>
      <p style="opacity:0.8;">
        Niveau : <strong>${session.niveau}</strong> (${session.nombreQuestions} questions)
      </p>
    </div>
  `;
}

function joinSession() {
  document.getElementById('joinSessionScreen').classList.add('hidden');
  document.getElementById('distanceQuizScreen').classList.remove('hidden');
  document.getElementById('distanceQuizTitle').textContent = `${partner2}, √† toi ! üíñ (${questions.length} questions)`;
  renderDistanceQuestions();
}

function startDistanceQuiz() {
  partner1 = document.getElementById('distancePartner1Name').value.trim();
  partner2 = document.getElementById('distancePartner2Name').value.trim();
  
  if (!partner1 || !partner2) {
    alert("Entre les deux pr√©noms s'il te pla√Æt üíï");
    return;
  }
  
  if (partner1.length < 2 || partner2.length < 2) {
    alert("Les pr√©noms doivent contenir au moins 2 caract√®res üíï");
    return;
  }

  questions = shuffleArray([...allQuestions]).slice(0, selectedQuestionCount);

  document.getElementById('distanceWelcomeScreen').classList.add('hidden');
  document.getElementById('distanceQuizScreen').classList.remove('hidden');
  document.getElementById('distanceQuizTitle').textContent = `${partner1}, √† toi ! üíñ (${questions.length} questions)`;
  renderDistanceQuestions();
}

function renderDistanceQuestions() {
  const cont = document.getElementById('distanceQuestionsContainer');
  cont.innerHTML = '';
  
  questions.forEach((q, i) => {
    const d = document.createElement('div');
    d.className = 'question-card';
    d.style.animationDelay = i * 0.05 + 's';
    
    const intensityEmoji = q.intensity === 1 ? 'üå±' : q.intensity === 2 ? 'üî•' : 'üíã';
    
    d.innerHTML = `
      <div style="font-weight:600;color:var(--peche);margin-bottom:8px;">
        Question ${i + 1}/${questions.length} ${intensityEmoji}
      </div>
      <div style="margin:12px 0;font-size:1.05em;">${escapeHtml(q.text)}</div>
      <input 
        type="text" 
        id="qd_${q.id}" 
        placeholder="Ta r√©ponse..." 
        oninput="updateDistanceProgress()"
        maxlength="200"
        autocomplete="off"
      >
    `;
    cont.appendChild(d);
  });
}

function updateDistanceProgress() {
  let completed = 0;
  questions.forEach(q => {
    const input = document.getElementById(`qd_${q.id}`);
    if (input?.value.trim()) completed++;
  });
  
  const percentage = Math.round((completed / questions.length) * 100);
  document.getElementById('distanceProgress').style.width = percentage + '%';
  document.getElementById('distanceProgressText').textContent = percentage + '% compl√©t√©';
  
  const submitBtn = document.getElementById('submitDistanceBtn');
  if (submitBtn) {
    submitBtn.disabled = completed < questions.length;
  }
}

async function submitDistanceQuiz() {
  const myAnswers = {};
  let allAnswered = true;
  
  questions.forEach(q => {
    const value = document.getElementById(`qd_${q.id}`)?.value.trim();
    if (!value) {
      allAnswered = false;
    } else {
      myAnswers[q.id] = value;
    }
  });
  
  if (!allAnswered) {
    alert("R√©ponds √† toutes les questions s'il te pla√Æt üíï");
    return;
  }
  
  if (currentSessionId) {
    // Partenaire 2 compl√®te la session
    answers1 = {}; 
    answers2 = myAnswers;
    await completeDistanceSessionWithAnswers();
  } else {
    // Partenaire 1 cr√©e la session
    answers1 = myAnswers;
    await createSessionAndShare();
  }
}

async function createSessionAndShare() {
  const sessionData = {
    partenaire1: partner1,
    partenaire2: partner2,
    nombreQuestions: selectedQuestionCount,
    niveau: selectedQuestionCount === 20 ? 'D√©butant' : 
            selectedQuestionCount === 50 ? 'Interm√©diaire' :
            selectedQuestionCount === 100 ? 'Avanc√©' : 'Extr√™me',
    questions: questions.map(q => q.id),
    reponses: answers1
  };
  
  const sessionId = await createDistanceSession(sessionData);
  
  if (!sessionId) {
    alert("Erreur lors de la cr√©ation de la session. V√©rifiez votre connexion.");
    return;
  }
  
  currentSessionId = sessionId;
  const shareUrl = window.location.origin + window.location.pathname + '?session=' + sessionId;
  
  document.getElementById('distanceQuizScreen').classList.add('hidden');
  document.getElementById('shareLinkScreen').classList.remove('hidden');
  document.getElementById('partnerNameToShare').textContent = partner2;
  document.getElementById('shareLink').textContent = shareUrl;
  document.getElementById('waitingPartnerName').textContent = partner2;
  
  // D√©marrer la v√©rification automatique toutes les 10 secondes
  setTimeout(startAutoCheck, 10000);
}

function copyShareLink() {
  const link = document.getElementById('shareLink').textContent;
  navigator.clipboard.writeText(link).then(() => {
    alert('‚úÖ Lien copi√© ! Envoie-le √† ton partenaire.');
  }).catch(() => {
    alert('S√©lectionne et copie le lien manuellement');
  });
}

let autoCheckInterval = null;

function startAutoCheck() {
  document.getElementById('waitingForPartner').classList.remove('hidden');
  autoCheckInterval = setInterval(checkSessionStatus, 10000);
}

async function checkSessionStatus() {
  if (!currentSessionId) return;
  
  const session = await getDistanceSession(currentSessionId);
  
  if (session && session.statut === 'complete') {
    clearInterval(autoCheckInterval);
    loadSessionResults(session);
  }
}

async function completeDistanceSessionWithAnswers() {
  const session = await getDistanceSession(currentSessionId);
  answers1 = session.reponses_partenaire1;
  
  const score = calculateScoreFromAnswers(answers1, answers2);
  
  await completeDistanceSession(currentSessionId, {
    reponses: answers2,
    score: score
  });
  
  loadSessionResults(await getDistanceSession(currentSessionId));
}

function loadSessionResults(session) {
  partner1 = session.partenaire1;
  partner2 = session.partenaire2;
  questions = allQuestions.filter(q => session.questions.includes(q.id));
  answers1 = session.reponses_partenaire1;
  answers2 = session.reponses_partenaire2;
  selectedMode = 'distance';
  
  document.querySelectorAll('.card').forEach(c => c.classList.add('hidden'));
  displayResults(session.score);
  }
